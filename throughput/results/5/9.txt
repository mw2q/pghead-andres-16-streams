BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%papaya%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263539068.044547
 ALGERIA                   |   1997 | 447121204.074101
 ALGERIA                   |   1996 |  450093045.46012
 ALGERIA                   |   1995 |   451507818.9017
 ALGERIA                   |   1994 | 450676096.638167
 ALGERIA                   |   1993 | 448938889.247615
 ALGERIA                   |   1992 |  460671588.90201
 ARGENTINA                 |   1998 | 276364738.103079
 ARGENTINA                 |   1997 | 465861018.132776
 ARGENTINA                 |   1996 | 470041118.759255
 ARGENTINA                 |   1995 | 462981274.239503
 ARGENTINA                 |   1994 |  459318320.49203
 ARGENTINA                 |   1993 | 461226532.263449
 ARGENTINA                 |   1992 | 474484376.716343
 BRAZIL                    |   1998 | 274462296.359658
 BRAZIL                    |   1997 | 464791035.066676
 BRAZIL                    |   1996 | 466541924.284298
 BRAZIL                    |   1995 | 467741127.312477
 BRAZIL                    |   1994 | 474113509.799804
 BRAZIL                    |   1993 |  470137724.06217
 BRAZIL                    |   1992 | 465823335.853438
 CANADA                    |   1998 | 279965347.916123
 CANADA                    |   1997 | 476859215.053216
 CANADA                    |   1996 | 472641243.926376
 CANADA                    |   1995 | 478134116.628775
 CANADA                    |   1994 |  480334392.23934
 CANADA                    |   1993 | 481948530.097434
 CANADA                    |   1992 | 476066809.616354
 CHINA                     |   1998 | 276303860.533026
 CHINA                     |   1997 | 469838277.480483
 CHINA                     |   1996 | 469339058.228001
 CHINA                     |   1995 | 475648538.306794
 CHINA                     |   1994 | 469270282.338563
 CHINA                     |   1993 |    466976166.965
 CHINA                     |   1992 | 475132292.324511
 EGYPT                     |   1998 | 268213623.552356
 EGYPT                     |   1997 | 463882477.297155
 EGYPT                     |   1996 | 464695755.775294
 EGYPT                     |   1995 | 458185470.435123
 EGYPT                     |   1994 | 463328062.343601
 EGYPT                     |   1993 | 461235417.923398
 EGYPT                     |   1992 | 462226851.281672
 ETHIOPIA                  |   1998 | 267358116.193302
 ETHIOPIA                  |   1997 | 455176785.341654
 ETHIOPIA                  |   1996 | 448748106.381532
 ETHIOPIA                  |   1995 | 457164943.853716
 ETHIOPIA                  |   1994 | 461578576.046001
 ETHIOPIA                  |   1993 | 448303638.159215
 ETHIOPIA                  |   1992 | 458971228.319448
 FRANCE                    |   1998 | 269343512.637771
 FRANCE                    |   1997 | 460919731.643064
 FRANCE                    |   1996 | 466333309.378004
 FRANCE                    |   1995 | 465281519.104971
 FRANCE                    |   1994 | 451353376.439652
 FRANCE                    |   1993 | 460081291.388476
 FRANCE                    |   1992 | 459708425.597661
 GERMANY                   |   1998 | 278017082.182758
 GERMANY                   |   1997 | 473229644.778581
 GERMANY                   |   1996 | 475334533.037376
 GERMANY                   |   1995 | 478602145.112458
 GERMANY                   |   1994 | 473219359.083368
 GERMANY                   |   1993 |  479290653.76166
 GERMANY                   |   1992 |  472734550.08702
 INDIA                     |   1998 |  274685560.90299
 INDIA                     |   1997 | 472330583.237803
 INDIA                     |   1996 | 468815694.047509
 INDIA                     |   1995 | 468560877.685475
 INDIA                     |   1994 | 474239387.890444
 INDIA                     |   1993 | 467384798.335727
 INDIA                     |   1992 | 464657118.006924
 INDONESIA                 |   1998 | 271697229.446499
 INDONESIA                 |   1997 | 466358648.981988
 INDONESIA                 |   1996 | 469045802.432281
 INDONESIA                 |   1995 | 465899991.567558
 INDONESIA                 |   1994 | 459240171.636951
 INDONESIA                 |   1993 | 476691055.174612
 INDONESIA                 |   1992 |  471102411.04424
 IRAN                      |   1998 |  273824779.29201
 IRAN                      |   1997 | 464907675.232829
 IRAN                      |   1996 | 474364381.146753
 IRAN                      |   1995 | 464214248.352566
 IRAN                      |   1994 | 472548679.072478
 IRAN                      |   1993 | 474092708.296165
 IRAN                      |   1992 |  476760857.18553
 IRAQ                      |   1998 | 276892472.885577
 IRAQ                      |   1997 | 470077437.391639
 IRAQ                      |   1996 | 470148806.083249
 IRAQ                      |   1995 | 467719806.717868
 IRAQ                      |   1994 | 480844034.175411
 IRAQ                      |   1993 | 476566580.552117
 IRAQ                      |   1992 | 469862302.064061
 JAPAN                     |   1998 | 271144320.874045
 JAPAN                     |   1997 | 463433409.791416
 JAPAN                     |   1996 | 473877216.050715
 JAPAN                     |   1995 |  472645139.79442
 JAPAN                     |   1994 | 466109765.920938
 JAPAN                     |   1993 | 470990768.538475
 JAPAN                     |   1992 | 468665959.643696
 JORDAN                    |   1998 | 268329971.742641
 JORDAN                    |   1997 | 459835013.226954
 JORDAN                    |   1996 | 460430295.158848
 JORDAN                    |   1995 | 449184140.206716
 JORDAN                    |   1994 | 459339345.666238
 JORDAN                    |   1993 | 462145436.616773
 JORDAN                    |   1992 | 455930214.319801
 KENYA                     |   1998 | 270820289.798352
 KENYA                     |   1997 | 476003141.265259
 KENYA                     |   1996 |  476237733.85728
 KENYA                     |   1995 | 477268737.783206
 KENYA                     |   1994 | 477124188.554746
 KENYA                     |   1993 | 470478723.974576
 KENYA                     |   1992 | 470043589.314768
 MOROCCO                   |   1998 | 275409102.071893
 MOROCCO                   |   1997 | 460418120.990268
 MOROCCO                   |   1996 | 462925674.901705
 MOROCCO                   |   1995 | 467991546.715966
 MOROCCO                   |   1994 | 462692090.380716
 MOROCCO                   |   1993 | 467335047.590203
 MOROCCO                   |   1992 | 473180472.800445
 MOZAMBIQUE                |   1998 | 261663542.157023
 MOZAMBIQUE                |   1997 | 447044500.659436
 MOZAMBIQUE                |   1996 |   456354765.4154
 MOZAMBIQUE                |   1995 | 462432513.095444
 MOZAMBIQUE                |   1994 | 450624953.029907
 MOZAMBIQUE                |   1993 | 456421296.571333
 MOZAMBIQUE                |   1992 | 448612229.541477
 PERU                      |   1998 | 275240757.862956
 PERU                      |   1997 | 461343707.466858
 PERU                      |   1996 | 464565082.980514
 PERU                      |   1995 | 461413254.331433
 PERU                      |   1994 | 468463586.156199
 PERU                      |   1993 | 459385542.628215
 PERU                      |   1992 | 457254960.149555
 ROMANIA                   |   1998 | 273824089.091315
 ROMANIA                   |   1997 | 461271604.984602
 ROMANIA                   |   1996 | 467030370.617063
 ROMANIA                   |   1995 |  466930958.73647
 ROMANIA                   |   1994 | 463237937.254761
 ROMANIA                   |   1993 | 459865528.075008
 ROMANIA                   |   1992 | 464544844.501639
 RUSSIA                    |   1998 | 275609744.307446
 RUSSIA                    |   1997 |   479896248.0691
 RUSSIA                    |   1996 | 476967524.639789
 RUSSIA                    |   1995 | 467982306.229952
 RUSSIA                    |   1994 | 470534536.967804
 RUSSIA                    |   1993 |  474389456.83497
 RUSSIA                    |   1992 | 475719362.210629
 SAUDI ARABIA              |   1998 | 277925418.701148
 SAUDI ARABIA              |   1997 | 473510650.145068
 SAUDI ARABIA              |   1996 | 478603089.553321
 SAUDI ARABIA              |   1995 | 470141904.462311
 SAUDI ARABIA              |   1994 | 481195824.260322
 SAUDI ARABIA              |   1993 |  471495420.13858
 SAUDI ARABIA              |   1992 | 472403745.219951
 UNITED KINGDOM            |   1998 | 280768564.794403
 UNITED KINGDOM            |   1997 | 467567406.006701
 UNITED KINGDOM            |   1996 |  465072971.22266
 UNITED KINGDOM            |   1995 | 470458489.039839
 UNITED KINGDOM            |   1994 | 463080102.243965
 UNITED KINGDOM            |   1993 | 472824558.419216
 UNITED KINGDOM            |   1992 | 464774833.808564
 UNITED STATES             |   1998 | 273044204.420206
 UNITED STATES             |   1997 | 476132163.010629
 UNITED STATES             |   1996 | 472134731.653001
 UNITED STATES             |   1995 | 477489563.425171
 UNITED STATES             |   1994 | 474425782.920363
 UNITED STATES             |   1993 | 477055363.339907
 UNITED STATES             |   1992 | 468978376.438041
 VIETNAM                   |   1998 | 274491182.035713
 VIETNAM                   |   1997 | 470031040.859707
 VIETNAM                   |   1996 | 470808341.598653
 VIETNAM                   |   1995 |  466342533.76697
 VIETNAM                   |   1994 | 464692331.850786
 VIETNAM                   |   1993 | 474898905.649026
 VIETNAM                   |   1992 | 470720572.921392
(175 rows)

COMMIT;
COMMIT
