BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264493306.443977
 ALGERIA                   |   1997 |  458009091.25458
 ALGERIA                   |   1996 | 464761553.549586
 ALGERIA                   |   1995 |  464662062.01146
 ALGERIA                   |   1994 | 466451308.011819
 ALGERIA                   |   1993 | 463444733.800275
 ALGERIA                   |   1992 | 462803777.243719
 ARGENTINA                 |   1998 |   278510659.2414
 ARGENTINA                 |   1997 | 469284718.738068
 ARGENTINA                 |   1996 | 466971238.047231
 ARGENTINA                 |   1995 | 468175928.457057
 ARGENTINA                 |   1994 | 471514002.209588
 ARGENTINA                 |   1993 | 468477470.248258
 ARGENTINA                 |   1992 | 462670883.860793
 BRAZIL                    |   1998 | 277051619.394913
 BRAZIL                    |   1997 | 472401345.593514
 BRAZIL                    |   1996 | 471825811.446594
 BRAZIL                    |   1995 | 467248783.847285
 BRAZIL                    |   1994 | 465864706.474801
 BRAZIL                    |   1993 | 469384790.425366
 BRAZIL                    |   1992 | 469045523.047411
 CANADA                    |   1998 | 272262955.544899
 CANADA                    |   1997 | 474398489.613368
 CANADA                    |   1996 | 475414203.722207
 CANADA                    |   1995 | 480859160.922424
 CANADA                    |   1994 | 475164966.655369
 CANADA                    |   1993 | 485402592.564815
 CANADA                    |   1992 | 479284988.736151
 CHINA                     |   1998 | 274057580.668985
 CHINA                     |   1997 | 466280555.815366
 CHINA                     |   1996 | 461723174.640466
 CHINA                     |   1995 | 468427136.865316
 CHINA                     |   1994 | 465283542.215521
 CHINA                     |   1993 | 464137038.350387
 CHINA                     |   1992 | 468101116.541233
 EGYPT                     |   1998 | 268537957.247689
 EGYPT                     |   1997 | 456185604.376119
 EGYPT                     |   1996 | 458628754.355473
 EGYPT                     |   1995 | 458232039.759658
 EGYPT                     |   1994 | 453859277.567433
 EGYPT                     |   1993 | 466647617.013298
 EGYPT                     |   1992 | 447206951.728511
 ETHIOPIA                  |   1998 |   271356980.5412
 ETHIOPIA                  |   1997 | 466484942.617471
 ETHIOPIA                  |   1996 | 462873985.586637
 ETHIOPIA                  |   1995 | 458065951.489217
 ETHIOPIA                  |   1994 |  464741602.67704
 ETHIOPIA                  |   1993 | 462727506.611486
 ETHIOPIA                  |   1992 | 469261848.994825
 FRANCE                    |   1998 | 267095251.898897
 FRANCE                    |   1997 | 456513634.910316
 FRANCE                    |   1996 | 455337927.565359
 FRANCE                    |   1995 | 461420500.548633
 FRANCE                    |   1994 | 468498606.711889
 FRANCE                    |   1993 | 460370515.685535
 FRANCE                    |   1992 |  461638856.16607
 GERMANY                   |   1998 | 277205422.294919
 GERMANY                   |   1997 | 481089043.282259
 GERMANY                   |   1996 | 480927074.284943
 GERMANY                   |   1995 | 479530765.609406
 GERMANY                   |   1994 | 479385721.992072
 GERMANY                   |   1993 | 483681887.290412
 GERMANY                   |   1992 | 480099742.728824
 INDIA                     |   1998 | 276039289.726776
 INDIA                     |   1997 | 475999036.459524
 INDIA                     |   1996 | 474382951.953038
 INDIA                     |   1995 | 480931468.760594
 INDIA                     |   1994 | 486751238.290145
 INDIA                     |   1993 | 473605935.195659
 INDIA                     |   1992 | 477085327.758301
 INDONESIA                 |   1998 | 269703168.528126
 INDONESIA                 |   1997 |  466034736.27959
 INDONESIA                 |   1996 | 470607712.576832
 INDONESIA                 |   1995 | 466128172.607634
 INDONESIA                 |   1994 | 473332665.528064
 INDONESIA                 |   1993 | 466537150.442012
 INDONESIA                 |   1992 | 469053981.371804
 IRAN                      |   1998 | 263861243.934146
 IRAN                      |   1997 | 456034607.055233
 IRAN                      |   1996 | 458580833.143392
 IRAN                      |   1995 | 459048331.163332
 IRAN                      |   1994 | 451620802.963848
 IRAN                      |   1993 | 453572723.008507
 IRAN                      |   1992 |  459944160.17454
 IRAQ                      |   1998 | 280550823.040004
 IRAQ                      |   1997 | 467710268.061086
 IRAQ                      |   1996 | 471370445.035554
 IRAQ                      |   1995 | 466792174.551415
 IRAQ                      |   1994 | 477400171.637738
 IRAQ                      |   1993 | 471840041.715926
 IRAQ                      |   1992 | 477338812.030332
 JAPAN                     |   1998 |  264795642.84376
 JAPAN                     |   1997 | 465009644.527511
 JAPAN                     |   1996 | 463778197.355868
 JAPAN                     |   1995 |  460060210.25177
 JAPAN                     |   1994 | 462148116.968056
 JAPAN                     |   1993 | 464745512.531359
 JAPAN                     |   1992 | 466218688.014995
 JORDAN                    |   1998 | 273013226.597449
 JORDAN                    |   1997 | 460033828.271502
 JORDAN                    |   1996 | 466665675.019577
 JORDAN                    |   1995 | 460888944.481664
 JORDAN                    |   1994 |  466550343.54432
 JORDAN                    |   1993 | 461454443.543255
 JORDAN                    |   1992 | 459945506.429454
 KENYA                     |   1998 | 268157754.259961
 KENYA                     |   1997 | 463134045.970328
 KENYA                     |   1996 | 468793531.927832
 KENYA                     |   1995 | 470102765.037304
 KENYA                     |   1994 | 462283662.114022
 KENYA                     |   1993 | 468934745.041224
 KENYA                     |   1992 | 473682248.499646
 MOROCCO                   |   1998 | 272169673.147251
 MOROCCO                   |   1997 | 471572240.471122
 MOROCCO                   |   1996 | 465994586.163425
 MOROCCO                   |   1995 | 470617988.233554
 MOROCCO                   |   1994 |  465754596.94066
 MOROCCO                   |   1993 |  470971869.60313
 MOROCCO                   |   1992 | 477681316.176399
 MOZAMBIQUE                |   1998 |  272464038.09145
 MOZAMBIQUE                |   1997 | 463029367.353085
 MOZAMBIQUE                |   1996 | 467428883.013374
 MOZAMBIQUE                |   1995 | 459011451.842168
 MOZAMBIQUE                |   1994 | 464646733.228043
 MOZAMBIQUE                |   1993 | 457323037.170843
 MOZAMBIQUE                |   1992 | 454475372.121149
 PERU                      |   1998 | 277825078.124332
 PERU                      |   1997 | 469754612.758786
 PERU                      |   1996 | 468816940.457963
 PERU                      |   1995 | 467801991.031039
 PERU                      |   1994 | 462782834.917158
 PERU                      |   1993 | 467208710.140733
 PERU                      |   1992 | 464238160.591398
 ROMANIA                   |   1998 | 272744385.812047
 ROMANIA                   |   1997 | 463326579.397563
 ROMANIA                   |   1996 | 471585994.155832
 ROMANIA                   |   1995 | 466228228.243432
 ROMANIA                   |   1994 | 461978897.845358
 ROMANIA                   |   1993 | 457668920.438414
 ROMANIA                   |   1992 | 467183144.558566
 RUSSIA                    |   1998 | 277774128.784803
 RUSSIA                    |   1997 | 475072486.096014
 RUSSIA                    |   1996 | 482123040.643106
 RUSSIA                    |   1995 | 467201412.705288
 RUSSIA                    |   1994 | 476456357.738778
 RUSSIA                    |   1993 | 474235978.285713
 RUSSIA                    |   1992 | 467699607.869288
 SAUDI ARABIA              |   1998 | 278605728.330645
 SAUDI ARABIA              |   1997 |  472735049.04694
 SAUDI ARABIA              |   1996 | 481877248.845687
 SAUDI ARABIA              |   1995 | 474143731.182823
 SAUDI ARABIA              |   1994 | 473435200.351844
 SAUDI ARABIA              |   1993 | 474018267.933886
 SAUDI ARABIA              |   1992 | 474155716.239817
 UNITED KINGDOM            |   1998 | 270682530.531508
 UNITED KINGDOM            |   1997 | 461452943.704863
 UNITED KINGDOM            |   1996 | 470689831.210008
 UNITED KINGDOM            |   1995 | 471668249.699216
 UNITED KINGDOM            |   1994 | 470990643.777118
 UNITED KINGDOM            |   1993 | 471444349.661549
 UNITED KINGDOM            |   1992 | 468524270.852958
 UNITED STATES             |   1998 | 277070607.410161
 UNITED STATES             |   1997 | 472929973.493979
 UNITED STATES             |   1996 | 477591943.526887
 UNITED STATES             |   1995 |  476401910.80503
 UNITED STATES             |   1994 | 484372751.045526
 UNITED STATES             |   1993 |  473848205.97501
 UNITED STATES             |   1992 | 474355620.239775
 VIETNAM                   |   1998 |  276620643.87305
 VIETNAM                   |   1997 | 468677744.218079
 VIETNAM                   |   1996 | 469768022.673784
 VIETNAM                   |   1995 | 468207566.462798
 VIETNAM                   |   1994 | 464496598.841522
 VIETNAM                   |   1993 | 472869042.172667
 VIETNAM                   |   1992 | 470440905.528211
(175 rows)

COMMIT;
COMMIT
